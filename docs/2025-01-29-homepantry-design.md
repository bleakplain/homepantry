# 家常味库 (HomePantry) 设计文档

## 项目概述

**名称：** 家常味库 / HomePantry

**定位：** 面向家庭主厨的温馨实用菜谱管理应用

**平台：** iOS + Android 原生应用

**数据存储：** 本地存储（无需云服务）

---

## 核心功能

### 1. 菜谱收藏
- 添加菜谱（手动输入/导入）
- 编辑菜谱信息
- 删除菜谱
- 菜谱分类管理
- 搜索和筛选菜谱
- 收藏/取消收藏

### 2. 食材推荐
- 管理个人食材库
- 根据现有食材推荐可做菜谱
- 食材过期提醒
- 智能菜谱推荐（基于喜好）

### 3. 家庭共享
- 家庭成员管理
- 共享菜谱库
- 添加菜谱时标记创建者
- 家庭成员互动（点赞/评论）

### 4. Meal Planning
- 周视图餐食计划
- 拖拽安排菜谱
- 自动生成购物清单
- 计划复制到其他日期

---

## 技术架构

### 整体架构

```
┌─────────────────┐      ┌─────────────────┐
│    iOS App      │      │  Android App    │
│   (Swift/UIKit) │      │ (Kotlin/Jetpack)│
│                 │      │                 │
│ ┌─────────────┐ │      │ ┌─────────────┐ │
│ │  UI Layer   │ │      │ │  UI Layer   │ │
│ └─────────────┘ │      │ └─────────────┘ │
│ ┌─────────────┐ │      │ ┌─────────────┐ │
│ │ ViewModel   │ │      │ │ ViewModel   │ │
│ └─────────────┘ │      │ └─────────────┘ │
│ ┌─────────────┐ │      │ ┌─────────────┐ │
│ │Repository   │ │      │ │Repository   │ │
│ └─────────────┘ │      │ └─────────────┘ │
│ ┌─────────────┐ │      │ ┌─────────────┐ │
│ │Local DB     │ │      │ │Local DB     │ │
│ │(Core Data)  │      │ │  (Room)      │ │
│ └─────────────┘ │      │ └─────────────┘ │
└─────────────────┘      └─────────────────┘
```

### iOS 技术栈
- 语言：Swift
- UI 框架：SwiftUI
- 架构模式：MVVM
- 本地存储：SwiftData (iOS 17+) 或 Core Data
- 图片存储：文件系统 + 缩略图缓存

### Android 技术栈
- 语言：Kotlin
- UI 框架：Jetpack Compose
- 架构模式：MVVM
- 本地存储：Room Database
- 图片存储：内部存储 + Coil 图片加载

---

## 数据模型设计

### 核心实体

```
Recipe (菜谱)
├── id: UUID
├── name: String
├── description: String?
├── imageUrl: String?
├── cookingTime: Int (分钟)
├── servings: Int (份数)
├── difficulty: DifficultyLevel
├── ingredients: [RecipeIngredient]
├── instructions: [String]
├── category: Category
├── tags: [String]
└── createdAt: Date

Ingredient (食材)
├── id: UUID
├── name: String
├── unit: String (克、毫升、个等)
├── category: IngredientCategory
├── shelfLifeDays: Int?
└── iconUrl: String?

RecipeIngredient (菜谱-食材关联)
├── recipeId: UUID
├── ingredientId: UUID
└── quantity: Double

MealPlan (餐食计划)
├── id: UUID
├── date: Date
├── mealType: MealType (早餐/午餐/晚餐)
├── recipeId: UUID
├── servings: Int
└── notes: String?

Category (分类)
├── id: UUID
├── name: String
├── icon: String?
├── color: String?
└── sortOrder: Int
```

---

## UI/UX 设计

### 主导航结构

```
┌─────────────────────────────────────┐
│  家常味库              🔔  👤       │
├─────────────────────────────────────┤
│  [搜索菜谱...]                      │
│                                     │
│  ┌─────┐ ┌─────┐ ┌─────┐ ┌─────┐   │
│  │ 📖  │ │ 🥬  │ │ 📅  │ │ 👨‍👩‍👧 │   │
│  │菜谱 │ │食材 │ │计划 │ │家庭 │   │
│  └─────┘ └─────┘ └─────┘ └─────┘   │
│                                     │
│  今日推荐                           │
│  ┌─────────────────────────────┐   │
│  │ 🍅 番茄炒蛋                │   │
│  │ ⏱ 15分钟 | 📊 简单         │   │
│  └─────────────────────────────┘   │
└─────────────────────────────────────┘
```

### 视觉风格
- **配色：** 温暖橙红（主色）+ 米白（背景）+ 深灰（文字）
- **圆角：** 大圆角卡片设计，亲切感
- **图标：** 线性图标，简洁温馨
- **字体：** 易读的无衬线字体

---

## 错误处理与边界情况

### 数据验证
- 菜谱名称必填，长度限制 2-50 字符
- 食材数量必须为正数
- 图片大小限制（5MB 以内）
- 烹饪时间必须为正整数

### 异常处理
- 数据库操作失败：显示友好提示，支持重试
- 图片加载失败：显示占位图
- 搜索无结果：显示空状态引导
- 存储空间不足：提示用户清理缓存

---

## 测试策略

### 单元测试
- Repository 层数据操作
- ViewModel 业务逻辑
- 食材推荐算法

### UI 测试
- 主要用户流程（添加/编辑/删除菜谱）
- 餐食计划创建和编辑

### 数据库测试
- 数据迁移测试
- 查询性能测试

---

## 开发里程碑

### Phase 1：MVP
- 菜谱收藏基础功能
- 简单搜索和分类
- 本地数据存储

### Phase 2：核心功能
- 食材管理和推荐
- Meal Planning
- 图片存储优化

### Phase 3：高级功能
- 家庭共享功能
- 智能推荐优化
- 数据导出/导入

---

*文档创建日期：2025-01-29*
