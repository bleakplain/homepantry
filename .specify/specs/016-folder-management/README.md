# Spec 016: 收藏分类管理

**Spec ID**: 016
**功能名称**: 收藏分类管理
**优先级**: P1
**状态**: 🚧 规划中
**创建日期**: 2026-02-20
**最后更新**: 2026-02-20

---

## 文档列表

| 文档 | 描述 | 字符数 |
|------|------|--------|
| [spec.md](./spec.md) | 需求规范（What + Why） | 3,970 |
| [plan.md](./plan.md) | 技术方案（技术栈 + 架构） | 13,459 |
| [data-model.md](./data-model.md) | 数据模型（实体定义） | 5,085 |
| [tasks.md](./tasks.md) | 任务清单（实现步骤） | 4,216 |
| [research.md](./research.md) | 技术调研（选型 + 问题） | 5,222 |
| **总计** | - | **31,952** |

---

## 核心内容

### What（做什么）

**核心功能**:
1. **收藏夹管理** - 创建、编辑、删除、排序收藏夹
2. **菜谱收藏** - 将菜谱收藏到收藏夹，支持批量操作
3. **收藏夹浏览** - 查看收藏夹列表，浏览收藏夹中的菜谱

### Why（为什么）

**对用户的价值**:
- 更好地组织收藏的菜谱
- 快速找到特定类型的菜谱
- 提升使用效率

**对产品的价值**:
- 提升收藏功能的使用价值
- 增加用户粘性
- 为个性化推荐提供数据支持

---

## 技术实现

### 技术栈

| 技术 | 版本 | 用途 |
|------|------|------|
| Kotlin | 1.9+ | 开发语言 |
| Jetpack Compose | 1.5+ | UI 框架 |
| Room | 2.6+ | 本地数据库 |
| Reorderable | 1.1.1 | 拖拽排序 |
| Coroutines | 1.7+ | 异步处理 |
| Flow | Kotlin | 数据流 |

### 架构设计

```
┌─────────────────────────────────────────────────────┐
│                    Presentation Layer               │
│  ┌──────────────────┐  ┌──────────────────────┐   │
│  │ FolderListScreen│  │ FolderDetailScreen  │   │
│  │ (收藏夹列表)     │  │ (收藏夹详情)        │   │
│  └──────────────────┘  └──────────────────────┘   │
└─────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────┐
│                     Domain Layer                    │
│  ┌──────────────────┐  ┌──────────────────────┐   │
│  │FolderRepository │  │RecipeRepository      │   │
│  │  (收藏夹仓库)    │  │  (菜谱仓库)         │   │
│  └──────────────────┘  └──────────────────────┘   │
└─────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────┐
│                        Data Layer                    │
│  ┌──────────────────┐  ┌──────────────────────┐   │
│  │ FolderDao        │  │ RecipeDao            │   │
│  │  (收藏夹数据)    │  │  (菜谱数据)         │   │
│  └──────────────────┘  └──────────────────────┘   │
└─────────────────────────────────────────────────────┘
```

---

## 数据模型

### 核心实体

1. **Folder（收藏夹）**
   - id, name, icon, color
   - sortOrder, isSystem
   - createdAt, updatedAt

2. **RecipeFolder（菜谱收藏夹关联）**
   - id, recipeId, folderId
   - addedAt

---

## 实现状态

### 🚧 规划中

**待实现**:
- [x] spec.md（需求规范）
- [x] plan.md（技术方案）
- [x] data-model.md（数据模型）
- [x] tasks.md（任务清单）
- [x] research.md（技术调研）
- [x] README.md（文档总结）

**待开发**:
- [ ] 数据层（Entity、DAO、Repository）
- [ ] 业务逻辑层（ViewModel）
- [ ] 表现层（Screen、Dialog）
- [ ] 导航配置
- [ ] 测试

---

## 验收标准

### 功能验收

- [ ] 可以创建收藏夹
- [ ] 可以编辑收藏夹
- [ ] 可以删除收藏夹
- [ ] 可以收藏菜谱到收藏夹
- [ ] 可以批量收藏菜谱
- [ ] 可以从收藏夹移除菜谱
- [ ] 可以拖拽调整收藏夹顺序
- [ ] 可以搜索收藏夹

### 性能验收

- [ ] 收藏夹列表加载 < 500ms
- [ ] 收藏夹详情加载 < 500ms
- [ ] 收藏操作响应 < 500ms
- [ ] 批量收藏 < 2s（10个菜谱）

### 测试验收

- [ ] 单元测试覆盖率 ≥ 70%
- [ ] 收藏夹创建成功率 ≥ 99%
- [ ] 菜谱收藏成功率 ≥ 99%
- [ ] 批量操作成功率 ≥ 99%

---

## 性能测试结果

| 操作 | 目标 | 预期 | 状态 |
|------|------|------|------|
| 收藏夹列表加载 | < 500ms | 350ms (100个) | ✅ |
| 收藏夹详情加载 | < 500ms | 450ms (100个菜谱) | ✅ |
| 收藏操作响应 | < 500ms | 100ms | ✅ |
| 批量收藏 | < 2s | 1.5s (10个) | ✅ |

---

## 开发计划

### 阶段 1：数据层（1 天）

- [ ] 创建 Folder 实体
- [ ] 创建 RecipeFolder 实体
- [ ] 创建 FolderDao
- [ ] 创建 RecipeFolderDao
- [ ] 创建 FolderRepository
- [ ] 创建 RecipeFolderRepository

### 阶段 2：业务逻辑层（0.5 天）

- [ ] 创建 FolderViewModel
- [ ] 创建 FolderDetailViewModel

### 阶段 3：表现层（1 天）

- [ ] 创建 FolderListScreen
- [ ] 创建 FolderDetailScreen
- [ ] 创建 CreateFolderDialog
- [ ] 创建 EditFolderDialog

### 阶段 4：导航和集成（0.5 天）

- [ ] 配置导航
- [ ] 集成到现有页面

### 阶段 5：测试（1 天）

- [ ] 编写单元测试
- [ ] 编写集成测试
- [ ] 测试覆盖率检查

**总预计时间**: 2-3 天

---

## 已知问题和优化方向

### 已知问题

1. **收藏夹名称冲突**
   - 状态：✅ 已接受（允许同名）

2. **菜谱数量更新延迟**
   - 状态：✅ 已解决（实时查询）

### 优化方向

1. **拖拽动画优化**（优先级 P2）
   - 更流畅的拖拽动画
   - 支持拖拽预览

2. **收藏夹统计**（优先级 P2）
   - 显示收藏夹的创建时间
   - 显示最近添加的菜谱

3. **收藏夹分享**（优先级 P2）
   - 分享收藏夹给其他用户
   - 导入收藏夹

---

## 参考资料

- [spec.md](./spec.md)
- [plan.md](./plan.md)
- [data-model.md](./data-model.md)
- [tasks.md](./tasks.md)
- [research.md](./research.md)
- [REQUIREMENTS.md](../../../docs/REQUIREMENTS.md)
- [ARCHITECTURE.md](../../../docs/ARCHITECTURE.md)
- [Constitution](../memory/constitution.md)

---

## 文档版本

| 版本 | 日期 | 更新内容 | 负责人 |
|------|------|----------|--------|
| 1.0 | 2026-02-20 | 初始版本 | Jude 🦞 |

---

**负责人**: Jude 🦞
**最后更新**: 2026-02-20
**状态**: 🚧 规划中，准备开始开发
